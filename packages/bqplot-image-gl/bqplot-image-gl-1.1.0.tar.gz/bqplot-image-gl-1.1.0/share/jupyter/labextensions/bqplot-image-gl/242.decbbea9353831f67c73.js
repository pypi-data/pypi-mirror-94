(self.webpackChunkbqplot_image_gl=self.webpackChunkbqplot_image_gl||[]).push([[242],{4900:(t,r,n)=>{"use strict";n.r(r),n.d(r,{contourDensity:()=>y,contours:()=>l});var e=n(4065),i=Array.prototype.slice;function a(t,r){return t-r}function o(t){return function(){return t}}function h(t,r){for(var n,e=-1,i=r.length;++e<i;)if(n=u(t,r[e]))return n;return 0}function u(t,r){for(var n=r[0],e=r[1],i=-1,a=0,o=t.length,h=o-1;a<o;h=a++){var u=t[a],c=u[0],d=u[1],l=t[h],s=l[0],g=l[1];if(f(u,l,r))return 0;d>e!=g>e&&n<(s-c)*(e-d)/(g-d)+c&&(i=-i)}return i}function f(t,r,n){var e,i,a,o;return function(t,r,n){return(r[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(r[1]-t[1])}(t,r,n)&&(i=t[e=+(t[0]===r[0])],a=n[e],o=r[e],i<=a&&a<=o||o<=a&&a<=i)}function c(){}var d=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function l(){var t=1,r=1,n=e._X,u=g;function f(t){var r=n(t);if(Array.isArray(r))r=r.slice().sort(a);else{var i=(0,e.We)(t),o=i[0],h=i[1];r=(0,e.ly)(o,h,r),r=(0,e.w6)(Math.floor(o/r)*r,Math.floor(h/r)*r,r)}return r.map((function(r){return l(t,r)}))}function l(n,e){var i=[],a=[];return function(n,e,i){var a,o,h,u,f,c,l=new Array,g=new Array;for(a=o=-1,u=n[0]>=e,d[u<<1].forEach(w);++a<t-1;)h=u,u=n[a+1]>=e,d[h|u<<1].forEach(w);for(d[u<<0].forEach(w);++o<r-1;){for(a=-1,u=n[o*t+t]>=e,f=n[o*t]>=e,d[u<<1|f<<2].forEach(w);++a<t-1;)h=u,u=n[o*t+t+a+1]>=e,c=f,f=n[o*t+a+1]>=e,d[h|u<<1|f<<2|c<<3].forEach(w);d[u|f<<3].forEach(w)}for(a=-1,f=n[o*t]>=e,d[f<<2].forEach(w);++a<t-1;)c=f,f=n[o*t+a+1]>=e,d[f<<2|c<<3].forEach(w);function w(t){var r,n,e=[t[0][0]+a,t[0][1]+o],h=[t[1][0]+a,t[1][1]+o],u=s(e),f=s(h);(r=g[u])?(n=l[f])?(delete g[r.end],delete l[n.start],r===n?(r.ring.push(h),i(r.ring)):l[r.start]=g[n.end]={start:r.start,end:n.end,ring:r.ring.concat(n.ring)}):(delete g[r.end],r.ring.push(h),g[r.end=f]=r):(r=l[f])?(n=g[u])?(delete l[r.start],delete g[n.end],r===n?(r.ring.push(h),i(r.ring)):l[n.start]=g[r.end]={start:n.start,end:r.end,ring:n.ring.concat(r.ring)}):(delete l[r.start],r.ring.unshift(e),l[r.start=u]=r):l[u]=g[f]={start:u,end:f,ring:[e,h]}}d[f<<3].forEach(w)}(n,e,(function(t){u(t,n,e),function(t){for(var r=0,n=t.length,e=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++r<n;)e+=t[r-1][1]*t[r][0]-t[r-1][0]*t[r][1];return e}(t)>0?i.push([t]):a.push(t)})),a.forEach((function(t){for(var r,n=0,e=i.length;n<e;++n)if(-1!==h((r=i[n])[0],t))return void r.push(t)})),{type:"MultiPolygon",value:e,coordinates:i}}function s(r){return 2*r[0]+r[1]*(t+1)*4}function g(n,e,i){n.forEach((function(n){var a,o=n[0],h=n[1],u=0|o,f=0|h,c=e[f*t+u];o>0&&o<t&&u===o&&(a=e[f*t+u-1],n[0]=o+(i-a)/(c-a)-.5),h>0&&h<r&&f===h&&(a=e[(f-1)*t+u],n[1]=h+(i-a)/(c-a)-.5)}))}return f.contour=l,f.size=function(n){if(!arguments.length)return[t,r];var e=Math.ceil(n[0]),i=Math.ceil(n[1]);if(!(e>0&&i>0))throw new Error("invalid size");return t=e,r=i,f},f.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?o(i.call(t)):o(t),f):n},f.smooth=function(t){return arguments.length?(u=t?g:c,f):u===g},f}function s(t,r,n){for(var e=t.width,i=t.height,a=1+(n<<1),o=0;o<i;++o)for(var h=0,u=0;h<e+n;++h)h<e&&(u+=t.data[h+o*e]),h>=n&&(h>=a&&(u-=t.data[h-a+o*e]),r.data[h-n+o*e]=u/Math.min(h+1,e-1+a-h,a))}function g(t,r,n){for(var e=t.width,i=t.height,a=1+(n<<1),o=0;o<e;++o)for(var h=0,u=0;h<i+n;++h)h<i&&(u+=t.data[o+h*e]),h>=n&&(h>=a&&(u-=t.data[o+(h-a)*e]),r.data[o+(h-n)*e]=u/Math.min(h+1,i-1+a-h,a))}function w(t){return t[0]}function v(t){return t[1]}function p(){return 1}function y(){var t=w,r=v,n=p,a=960,h=500,u=20,f=2,c=3*u,d=a+2*c>>f,y=h+2*c>>f,E=o(20);function M(i){var a=new Float32Array(d*y),o=new Float32Array(d*y);i.forEach((function(e,i,o){var h=+t(e,i,o)+c>>f,u=+r(e,i,o)+c>>f,l=+n(e,i,o);h>=0&&h<d&&u>=0&&u<y&&(a[h+u*d]+=l)})),s({width:d,height:y,data:a},{width:d,height:y,data:o},u>>f),g({width:d,height:y,data:o},{width:d,height:y,data:a},u>>f),s({width:d,height:y,data:a},{width:d,height:y,data:o},u>>f),g({width:d,height:y,data:o},{width:d,height:y,data:a},u>>f),s({width:d,height:y,data:a},{width:d,height:y,data:o},u>>f),g({width:d,height:y,data:o},{width:d,height:y,data:a},u>>f);var h=E(a);if(!Array.isArray(h)){var w=(0,e.Fp)(a);h=(0,e.ly)(0,w,h),(h=(0,e.w6)(0,Math.floor(w/h)*h,h)).shift()}return l().thresholds(h).size([d,y])(a).map(A)}function A(t){return t.value*=Math.pow(2,-2*f),t.coordinates.forEach(m),t}function m(t){t.forEach(z)}function z(t){t.forEach(b)}function b(t){t[0]=t[0]*Math.pow(2,f)-c,t[1]=t[1]*Math.pow(2,f)-c}function _(){return d=a+2*(c=3*u)>>f,y=h+2*c>>f,M}return M.x=function(r){return arguments.length?(t="function"==typeof r?r:o(+r),M):t},M.y=function(t){return arguments.length?(r="function"==typeof t?t:o(+t),M):r},M.weight=function(t){return arguments.length?(n="function"==typeof t?t:o(+t),M):n},M.size=function(t){if(!arguments.length)return[a,h];var r=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(r>=0||r>=0))throw new Error("invalid size");return a=r,h=n,_()},M.cellSize=function(t){if(!arguments.length)return 1<<f;if(!((t=+t)>=1))throw new Error("invalid cell size");return f=Math.floor(Math.log(t)/Math.LN2),_()},M.thresholds=function(t){return arguments.length?(E="function"==typeof t?t:Array.isArray(t)?o(i.call(t)):o(t),M):E},M.bandwidth=function(t){if(!arguments.length)return Math.sqrt(u*(u+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return u=Math.round((Math.sqrt(4*t*t+1)-1)/2),_()},M}}}]);