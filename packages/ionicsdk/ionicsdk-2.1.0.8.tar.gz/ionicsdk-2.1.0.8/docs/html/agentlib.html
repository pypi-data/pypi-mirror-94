<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.18" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="Description" content="Machina Client SDK Version 2.1.0: Ionic Security Machina Client SDK for Python users" />
<meta name="keywords" content="AgentKeyServices Implementors Overview" />
<meta name="keywords" content="ionicsdk.agent.Agent" />
<meta name="keywords" content="ionicsdk.agent.Agent.createkey" />
<meta name="keywords" content="ionicsdk.agent.Agent.createkeys" />
<meta name="keywords" content="ionicsdk.agent.Agent.getkeyspace" />
<meta name="keywords" content="ionicsdk.agent.Agent.loadprofiles" />
<meta name="keywords" content="ionicsdk.agent.Agent.saveprofiles" />
<meta name="keywords" content="ionicsdk.agent.Agent.updateprofile" />
<meta name="keywords" content="ionicsdk.common.DeviceProfile" />
<meta name="keywords" content="ionicsdk.common.DeviceProfilePersistorBase" />
<title>Machina Client SDK Version 2.1.0: Agent Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="ISAgentSDK.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Machina Client SDK Version 2.1.0
   </div>
   <div id="projectbrief">Ionic Security Machina Client SDK for Python users</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Agent Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#agentlib-introduction">Introduction to Agent</a></li>
<li class="level1"><a href="#agentlib-keyservices">Using AgentKeyServices</a></li>
<li class="level1"><a href="#agentlib-config">Initializing Agent</a></li>
<li class="level1"><a href="#profilepersistor">Device Profile Persistor</a></li>
<li class="level1"><a href="#agentlib-kns">KNS (Keyspace Name Service) features in SDK</a></li>
<li class="level1"><a href="#agentlib-createkeys">Creating Keys</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="agentlib-introduction"></a>
Introduction to Agent</h1>
<p>Agent is the client-side library class for all Ionic.com API endpoint communication.</p>
<p><br />
</p>
<h1><a class="anchor" id="agentlib-keyservices"></a>
Using AgentKeyServices</h1>
<p>Agent provides a default implementation of AgentKeyServices interface. It is possible for a user to override that interface and provide their own backend solution for key services (for example Offline Key Vault), that can be used by the ciphers for encryption and decryption. <br />
Please see the <a class="el" href="isagentkeyservices.html">AgentKeyServices Implementors Overview</a>.</p>
<p><br />
</p>
<h1><a class="anchor" id="agentlib-config"></a>
Initializing Agent</h1>
<p>Before you can begin using an Agent object, it must first be initialized. The initialization process performs device profile loading and other non-trivial internal resource initialization to prepare it for secure communication with Ionic API servers.</p>
<p>Initializing an Agent object can be done a few different ways. If all configuration defaults are ok (which is typical) then you can simply create an Agent instance, Agent().</p>
<p><b>Simplest Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># create an agent and initialize it using all defaults</span></div>
<div class="line">myAgent = ionicsdk.Agent()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># On error, the agent will throw an exception</span></div>
</div><!-- fragment --><p>If you need to provide some custom configuration, then you can create a configuration object and pass it to the Agent constructor.</p>
<p><b>Custom Configuration Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create an agent configuration object</span></div>
<div class="line">myConfig = ionicsdk.AgentConfig(<span class="stringliteral">'My Application Name'</span>)</div>
<div class="line">myConfig.httptimeoutsecs = 20</div>
<div class="line">myConfig.maxredirects = 2</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Initialize the agent from our config object</span></div>
<div class="line">myAgent = ionicsdk.Agent(agentconfig=myConfig) </div>
</div><!-- fragment --><p><br />
If you need to provide a custom device profile persistor to load device profiles using a custom implementation, then you can create it and pass it to the Agent constructor.</p>
<p><b>Custom Configuration with Custom Device Profile Persistor:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create an agent configuration object</span></div>
<div class="line">myConfig = ionicsdk.AgentConfig(<span class="stringliteral">'My Application Name'</span>)</div>
<div class="line">myConfig.httptimeoutsecs = 20</div>
<div class="line">myConfig.maxredirects = 2</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Use any non-default profile persistor.</span></div>
<div class="line">profilePersistor = ionicsdk.DeviceProfilePersistorPlaintextFile(<span class="stringliteral">"testfile.txt"</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Initialize the agent from the config object and persistor object.</span></div>
<div class="line"><span class="comment"># The persistor is used to automatically load device profiles.</span></div>
<div class="line">myAgent = ionicsdk.Agent(agentconfig=myConfig, profilepersistor=profilePersistor) </div>
</div><!-- fragment --><p><br />
</p>
<h1><a class="anchor" id="profilepersistor"></a>
Device Profile Persistor</h1>
<p>Implementations of <a class="el" href="classionicsdk_1_1common_1_1_device_profile_persistor_base.html">ionicsdk.common.DeviceProfilePersistorBase</a> are typically backed by a file on a filesystem available to the <a class="el" href="classionicsdk_1_1agent_1_1_agent.html">ionicsdk.agent.Agent</a> process. The agent maintains an in-memory cache of <a class="el" href="classionicsdk_1_1common_1_1_device_profile.html">ionicsdk.common.DeviceProfile</a> objects for use during cryptography operations. The API <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#ab66da2519abcf4fb3a11cdfd4a0cb6f4">ionicsdk.agent.Agent.loadprofiles</a> causes the agent cache of DeviceProfile objects to be replaced with those retrieved from the file. The API <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#a3f9c131fc8047a4723efd5b168e3e2c1" title="(DEPRECATED) Save device profiles using the specified profile persistor.">ionicsdk.agent.Agent.saveprofiles</a> causes the serialized DeviceProfilePersistor file to be merged with the records from the agent cache. No internal reference to a DeviceProfilePersistor is maintained by the Agent.</p>
<p><br />
</p>
<h1><a class="anchor" id="agentlib-kns"></a>
KNS (Keyspace Name Service) features in SDK</h1>
<p>The KNS features allow users to query information about a particular keyspace. Using the <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#ad9bfc9dfd82f6a2b5aaa30006dce73f8">ionicsdk.agent.Agent.getkeyspace</a> function users can get the tenant ID, the fully qualified domain name, the API URL and finally the enrollment URL. SDK clients (like the Machina CLI) can use this query during enrollment to get the enrollment URL. While enrollment will set up the initial API URL, a user can still use the KNS query to make sure the keyspace API URL hasn't moved. Finally, SDK includes a convenience function for updating a particular device profile, <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#a215fdfc4f519fa9e77198aba14714ba9">ionicsdk.agent.Agent.updateprofile</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create an agent and initialize it using all defaults</span></div>
<div class="line">myAgent = ionicsdk.Agent()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Update the active profile from the default Ionic KNS provider.</span></div>
<div class="line">myAgent.updateprofile()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># ----- OR -----</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Retrieve the list of profiles.</span></div>
<div class="line">proflist = myAgent.getallprofiles()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Iterate over the list, and update each profile.</span></div>
<div class="line"><span class="keywordflow">for</span> profile <span class="keywordflow">in</span> proflist:</div>
<div class="line">  myAgent.updateprofile(profile)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># ----- OR -----</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Retrieve the list of profiles</span></div>
<div class="line">proflist = myAgent.getallprofiles()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Iterate over the list, and update each profile, from a non-default KNS server</span></div>
<div class="line"><span class="keywordflow">for</span> profile <span class="keywordflow">in</span> proflist:</div>
<div class="line">  myAgent.updateprofile(profile, <span class="stringliteral">"www.myknsserver.com"</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Finally, persist any changes</span></div>
<div class="line">agent.saveprofiles();</div>
</div><!-- fragment --><p><br />
</p>
<h1><a class="anchor" id="agentlib-createkeys"></a>
Creating Keys</h1>
<p>In order to protect sensitive data, keys must be requested from Agent using <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#af6a92362d4d76689d7b071e5445c70b5" title="Creates a single protection key with attributes through Ionic.com.">ionicsdk.agent.Agent.createkey</a> or <a class="el" href="classionicsdk_1_1agent_1_1_agent.html#a47c5d86a1c675d540da5d511e03a0a70" title="Creates protection keys through Ionic.com.">ionicsdk.agent.Agent.createkeys</a> along with optional MetadataMap and AttributesMap objects to hold information about the application and data being secured.</p>
<p><b>Example of creating a single key:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create an agent and initialize it using all defaults</span></div>
<div class="line">myAgent = ionicsdk.Agent()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set up our desired key attributes for the key</span></div>
<div class="line">attributes = {<span class="stringliteral">"classification"</span>:(<span class="stringliteral">"confidential"</span>,),<span class="stringliteral">"allowedGroups"</span>:(<span class="stringliteral">"admins"</span>,<span class="stringliteral">"mods"</span>)}</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Try to create the key.</span></div>
<div class="line"><span class="comment"># This will communicate with an Ionic server over the network.</span></div>
<div class="line">createdKey = myAgent.createkey(attributes)</div>
</div><!-- fragment --><p><b>Example of creating multiple keys:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create an agent and initialize it using all defaults</span></div>
<div class="line">myAgent = ionicsdk.Agent()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set up a key request object that will create five keys, each one having</span></div>
<div class="line"><span class="comment"># key attributes that indicate they will be protecting a social security number</span></div>
<div class="line">attr = {<span class="stringliteral">"contains"</span>:(<span class="stringliteral">"ssn"</span>,)}</div>
<div class="line"> </div>
<div class="line">createdKeys = myAgent.createkeys(5, attr)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># CreatedKeys is a list of 5 keys, or on error, createkeys will throw an exception</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer" /><address class="footer">
<p class="small">You acknowledge your access, review and use of the documentation on this page is subject to the Ionic Security Inc. <a href="https://dev.ionic.com/use.html">Documentation Use Rights</a>.</p>
<p class="small">&copy; 2016-2021 Ionic Security Inc. All rights reserved.&#160;-&#160;
Generated on Wed Feb 3 2021 17:16:19 for Machina Client SDK Version 2.1.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen" />
</a> 1.8.18 </p>
</address>

</body>
</html>
