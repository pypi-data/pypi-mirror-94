
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Extensions &#8212; django-extensions 3.1.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Extensions" href="command_extensions.html" />
    <link rel="prev" title="Installation instructions" href="installation_instructions.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="command_extensions.html" title="Command Extensions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation_instructions.html" title="Installation instructions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">django-extensions 3.1.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Admin Extensions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="admin-extensions">
<h1>Admin Extensions<a class="headerlink" href="#admin-extensions" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">synopsis</dt>
<dd class="field-odd"><p>Admin Extensions</p>
</dd>
</dl>
<ul class="simple">
<li><p><em>ForeignKeyAutocompleteAdmin</em> - ForeignKeyAutocompleteAdmin will enable the
admin app to show ForeignKey fields with an search input field. The search
field is rendered by the ForeignKeySearchInput form widget and uses jQuery
to do configurable autocompletion.</p></li>
<li><p><em>ForeignKeyAutocompleteStackedInline</em>, <em>ForeignKeyAutocompleteTabularInline</em> -
in the same fashion of the <em>ForeignKeyAutocompleteAdmin</em> these two classes
enable a search input field for ForeignKey fields in AdminInline classes.</p></li>
</ul>
<div class="section" id="depreciation">
<h2>Depreciation<a class="headerlink" href="#depreciation" title="Permalink to this headline">¶</a></h2>
<p>Django 2.0 now contains similar functionality as <em>ForeignKeyAutocompleteAdmin</em> therefore we are deprecating this extension and highly encouraging everyone to update to it.</p>
<p>This code will be removed in the near future when support for Django older then 2.0 is dropped.</p>
<p>More on this: <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/contrib/admin/#django.contrib.admin.ModelAdmin.autocomplete_fields">https://docs.djangoproject.com/en/2.0/ref/contrib/admin/#django.contrib.admin.ModelAdmin.autocomplete_fields</a></p>
</div>
<div class="section" id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>SECURITY ISSUE: Autocompletion does not check permissions nor the requested models on the autocompletion view. This can be used by users with access to the admin to expose data from other models. Please be aware and careful when using <em>ForeignKeyAutocompleteAdmin</em>.</p></li>
<li><p>The current version of the <em>ForeignKeyAutocompleteAdmin</em> has issues with recent Django versions.</p></li>
<li><p>We strongly suggest project using this extension to update to Django 2.0 and use the native <em>autocomplete_fields</em>.</p></li>
</ul>
</div>
<div class="section" id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>To enable the Admin Autocomplete you can follow this code example
in your admin.py file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">foo.models</span> <span class="kn">import</span> <span class="n">Permission</span>
<span class="kn">from</span> <span class="nn">django_extensions.admin</span> <span class="kn">import</span> <span class="n">ForeignKeyAutocompleteAdmin</span>


<span class="k">class</span> <span class="nc">PermissionAdmin</span><span class="p">(</span><span class="n">ForeignKeyAutocompleteAdmin</span><span class="p">):</span>
    <span class="c1"># User is your FK attribute in your model</span>
    <span class="c1"># first_name and email are attributes to search for in the FK model</span>
    <span class="n">related_search_fields</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;avatar&#39;</span><span class="p">,</span> <span class="s1">&#39;is_active&#39;</span><span class="p">)</span>

    <span class="o">...</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Permission</span><span class="p">,</span> <span class="n">PermissionAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are using django-reversion you should follow this code example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">foo.models</span> <span class="kn">import</span> <span class="n">MyVersionModel</span>
<span class="kn">from</span> <span class="nn">reversion.admin</span> <span class="kn">import</span> <span class="n">VersionAdmin</span>
<span class="kn">from</span> <span class="nn">django_extensions.admin</span> <span class="kn">import</span> <span class="n">ForeignKeyAutocompleteAdmin</span>


<span class="k">class</span> <span class="nc">MyVersionModelAdmin</span><span class="p">(</span><span class="n">VersionAdmin</span><span class="p">,</span> <span class="n">ForeignKeyAutocompleteAdmin</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyVersionModel</span><span class="p">,</span> <span class="n">MyVersionModelAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>If you need to limit the autocomplete search, you can override the
<code class="docutils literal notranslate"><span class="pre">get_related_filter</span></code> method of the admin. For example if you want to allow
non-superusers to attach attachments only to articles they own you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AttachmentAdmin</span><span class="p">(</span><span class="n">ForeignKeyAutocompleteAdmin</span><span class="p">):</span>

    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_related_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Article</span><span class="p">)</span> <span class="ow">or</span> <span class="n">user</span><span class="o">.</span><span class="n">is_superuser</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AttachmentAdmin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_related_filter</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">request</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">Q</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this does not protect your application from malicious attempts to
circumvent it (e.g. sending fabricated requests via cURL).</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Admin Extensions</a><ul>
<li><a class="reference internal" href="#depreciation">Depreciation</a></li>
<li><a class="reference internal" href="#known-issues">Known Issues</a></li>
<li><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation_instructions.html"
                        title="previous chapter">Installation instructions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="command_extensions.html"
                        title="next chapter">Command Extensions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/admin_extensions.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="command_extensions.html" title="Command Extensions"
             >next</a> |</li>
        <li class="right" >
          <a href="installation_instructions.html" title="Installation instructions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">django-extensions 3.1.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Admin Extensions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Copyright (C) 2008-2015 Michael Trier, Bas van Oostveen and contributors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>