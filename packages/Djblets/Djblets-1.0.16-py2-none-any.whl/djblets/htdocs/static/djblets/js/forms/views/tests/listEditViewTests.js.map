{"version":3,"sources":["listEditViewTests.es6.js"],"names":[],"mappings":"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","file":"listEditViewTests.js","sourcesContent":["suite('djblets/forms/views/ListEditView', () => {\n    const addImgUrl = '/static/admin/img/icon_addlink.gif';\n    const delImgUrl = '/static/admin/img/icon_deletelink.gif';\n\n    /*\n     * See templates/djblets_forms/list_edit_widget.html.\n     */\n    const formTemplate = _.template(dedent`\n        <div class=\"list-edit-widget\" id=\"<%- id %>_container\">\n         <ul>\n         <% if (items.length > 0) { %>\n          <% items.forEach(function(item, i) { %>\n           <li class=\"list-edit-entry\" data-list-index=\"<%- i %>\">\n            <input value=\"<%- item %>\" type=\"text\"<%- attrs %>>\n            <a href=\"#\" class=\"list-edit-remove-item\">\n             <img src=\"${delImgUrl}\">\n            </a>\n           </li>\n          <% }); %>\n         <% } else { %>\n           <li class=\"list-edit-entry\" data-list-index=\"0\">\n            <input type=\"text\">\n            <a href=\"#\" class=\"list-edit-remove-item\">\n             <img src=\"${delImgUrl}\">\n            </a>\n           </li>\n         <% } %>\n          <li>\n           <a href=\"#\" class=\"list-edit-add-item\"><img src=\"${addImgUrl}\"></a>\n          </li>\n         </ul>\n         <input id=\"<%- id %>\" type=\"hidden\"\n                value=\"<%- nonZeroItems.join(',') %>\">\n        </div>\n    `);\n\n    const makeView = function makeView(items=[], attrs='') {\n        attrs = attrs.length ? ` ${attrs}` : '';\n\n        $testsScratch.append($(formTemplate({\n            items: items,\n            nonZeroItems: items.filter(i => (i.length > 0)),\n            attrs: attrs,\n            id: 'list-edit',\n        })));\n\n        const view = new Djblets.Forms.ListEditView({\n            el: '#list-edit_container',\n            inputAttrs: attrs,\n            deleteImageUrl: delImgUrl,\n            sep: ',',\n        });\n\n        view.render();\n\n        return [view, view.$('#list-edit')];\n    };\n\n    describe('Updating fields', () => {\n        it('With no values', () => {\n            const [, $valueField] = makeView([]);\n            expect($valueField.val()).toEqual('');\n        });\n\n        it('With one value', () => {\n            const [view, $valueField] = makeView(['One']);\n\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.list-edit-entry input').val('Foo').blur();\n            expect($valueField.val()).toEqual('Foo');\n        });\n\n        it('With multiple values', () => {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            const $inputs = view.$('.list-edit-entry input');\n\n            expect($valueField.val()).toEqual('one,two,three');\n\n            $inputs.eq(2).val('baz').blur();\n            expect($valueField.val()).toEqual('one,two,baz');\n\n            $inputs.eq(0).val('').blur();\n            expect($valueField.val()).toEqual('two,baz');\n\n            $inputs.eq(1).val('').blur();\n            expect($valueField.val()).toEqual('baz');\n\n            $inputs.eq(2).val('').blur();\n            expect($valueField.val()).toEqual('');\n        });\n    });\n\n    describe('Removal', () => {\n        it('With no values', () => {\n            const [view, $valueField] = makeView([]);\n\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.list-edit-entry').length).toEqual(1);\n\n            view.$('.list-edit-remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.list-edit-entry').length).toEqual(1);\n        });\n\n        it ('With one value', () => {\n            const [view, $valueField] = makeView(['One']);\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.list-edit-remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.list-edit-entry').length).toEqual(1);\n        });\n\n        it('With multiple values', () => {\n            const [view, $valueField] = makeView(['One', 'Two', 'Three']);\n\n            expect($valueField.val()).toEqual('One,Two,Three');\n\n            view.$('.list-edit-remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One,Three');\n            expect(view.$('.list-edit-entry').length).toEqual(2);\n\n            view.$('.list-edit-remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One');\n            expect(view.$('.list-edit-entry').length).toEqual(1);\n\n            view.$('.list-edit-remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.list-edit-entry').length).toEqual(1);\n        });\n    });\n\n    describe('Addition', () => {\n        it('With values', () => {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            expect($valueField.val()).toEqual('one,two,three');\n\n            view.$('.list-edit-add-item').click();\n            expect($valueField.val()).toEqual('one,two,three');\n            expect(view.$('.list-edit-entry').length).toEqual(4);\n\n            view.$('.list-edit-entry input').eq(3).val('four').blur();\n            expect($valueField.val()).toEqual('one,two,three,four');\n        });\n\n        it('With blank values', () => {\n            const [view, $valueField] = makeView(['', '', '']);\n            expect($valueField.val()).toEqual('');\n\n            view.$('.list-edit-add-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.list-edit-entry').length).toEqual(4);\n\n            view.$('.list-edit-entry input').eq(3).val('four').blur();\n            expect($valueField.val()).toEqual('four');\n        });\n\n        it('With correct attributes', () => {\n            const [view,] = makeView([], 'size=\"100\" readonly');\n\n            view.$('.list-edit-add-item').click();\n            const $input = view.$('input').eq(1);\n            expect($input.attr('size')).toEqual('100');\n            expect($input.prop('readonly')).toBe(true);\n        });\n    });\n});\n"]}