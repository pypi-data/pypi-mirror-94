(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{481:function(e,t,s){"use strict";s.r(t);var o=s(10),i={name:"gsrp5-tree-view",props:{metas:Object,model:String,mode:String},data:()=>({fields:[],selectionFrom:{},selectionFromForm:{},emptytext:"Data not found",props:{stripe:!1,border:!1,showHeader:!0,showSummary:!1,showRowHover:!0,showIndex:!1,treeType:!0,isFold:!0,children:"children",expandType:!1,selectionType:!1},meta:null,views:null,view:null,actions:[],data:[],columns:[]}),methods:{_buildTemplate(){-1==this.fields.indexOf(this.meta.names.parent_id)&&this.fields.push(this.meta.names.parent_id),-1==this.fields.indexOf(this.meta.names.childs_id)&&this.fields.push(this.meta.names.childs_id);for(let e,t=0;t<this.fields.length;t++)if(e=this.fields[t],-1==[this.meta.names.parent_id,this.meta.names.childs_id].indexOf(e))switch(this.meta.columns[this.fields[t]].type){case"many2one":case"related":this.columns.push({label:this.meta.columns[e].label,prop:e+".name"});break;case"selection":this.selectionFromForm[e]=Object(o.B)(this.metas[this.model].meta.columns[e].selections),this.selectionFrom[e]=Object(o.A)(this.metas[this.model].meta.columns[e].selections),this.columns.push({label:this.meta.columns[e].label,prop:e});break;case"one2many":case"many2many":break;default:this.columns.push({label:this.meta.columns[e].label,prop:e})}this.props.children=this.meta.names.childs_id},onTree(e){e.length>0&&this.data.splice(0,this.data.length,...e)}},mixins:[{methods:{send:o.C}}],created(){this.$websocket.registerComponent({n:`${this.$options.name}:${this._uid}`,c:this}),this.meta=this.metas[this.model].meta,this.views=this.metas[this.model].views,this.view=this.views.tree,this.name=this.meta.description,this.actions=this.meta.actions,this.fields=Object.keys(this.view.columns),this.template=this._buildTemplate()},mounted(){this.send("onTree",["models",this.model,"tree",{fields:this.fields}])},beforeDestroy(){this.$websocket.unregisterComponent(`${this.$options.name}:${this._uid}`)}},a=s(19),n=Object(a.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("zk-table",{ref:"table",attrs:{"sum-text":"sum","index-text":"#",data:e.data,columns:e.columns,stripe:e.props.stripe,border:e.props.border,"show-header":e.props.showHeader,"show-summary":e.props.showSummary,"show-row-hover":e.props.showRowHover,"show-index":e.props.showIndex,"tree-type":e.props.treeType,"is-fold":e.props.isFold,"children-prop":e.props.children,"expand-type":e.props.expandType,"selection-type":e.props.selectionType,"empty-text":e.emptytext},scopedSlots:e._u([{key:"$expand",fn:function(t){return[e._v("\n        "+e._s(t.row[e.metas[e.meta.columns[e.meta.names.childs_id].obj].meta.names.rec_name])+"\n      ")]}},null!=e.view.columns?e._l(Object.keys(e.view.columns),(function(t){return{key:"likes",fn:function(o){return[["many2one","related"].indexOf(e.meta.columns[t].type)>=0?[e._v(e._s(o.row[t].name))]:"selection"==e.meta.columns[t].type?[e._v(e._s(e.selectionFromForm[t][o.row[t]]))]:"boolean"==e.meta.columns[t].type?[s("v-checkbox",{attrs:{disabled:"","hide-details":""},model:{value:o.row[t],callback:function(s){e.$set(o.row,t,s)},expression:"scope.row[field]"}})]:"datetime"==e.meta.columns[t].type?[e._v(e._s(e._f("formatDatetime")(o.row[t])))]:"date"==e.meta.columns[t].type?[e._v(e._s(e._f("formatDate")(o.row[t])))]:"time"==e.meta.columns[t].type?[e._v(e._s(e._f("formatTime")(o.row[t])))]:"timedelta"==e.meta.columns[t].type?[e._v(e._s(e._f("formatTimedelta")(o.row[t])))]:"referenced"==e.meta.columns[t].type?[["many2one","related"].indexOf(e.meta.columns[t].reftype)>=0?[e._v(e._s(o.row[t].name))]:"selection"==e.meta.columns[t].reftype?[e._v(e._s(e.selectionFromForm[t][o.row[t]]))]:"boolean"==e.meta.columns[t].reftype?[s("v-checkbox",{attrs:{disabled:"","hide-details":""},model:{value:o.row[t],callback:function(s){e.$set(o.row,t,s)},expression:"scope.row[field]"}})]:"datetime"==e.meta.columns[t].reftype?[e._v(e._s(e._f("formatDatetime")(o.row[t])))]:"date"==e.meta.columns[t].reftype?[e._v(e._s(e._f("formatDate")(o.row[t])))]:"time"==e.meta.columns[t].reftype?[e._v(e._s(e._f("formatTime")(o.row[t])))]:"timedelta"==e.meta.columns[t].reftype?[e._v(e._s(e._f("formatTimedelta")(o.row[t])))]:[e._v(e._s(o.row[t]))]]:"one2many"==e.meta.columns[t].type?[e._v(e._s(t))]:[e._v(e._s(o.row[t]))]]}}})):null],null,!0)})}),[],!1,null,null,null);t.default=n.exports}}]);