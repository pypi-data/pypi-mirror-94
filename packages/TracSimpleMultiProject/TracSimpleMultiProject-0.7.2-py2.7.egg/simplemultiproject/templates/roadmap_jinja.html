{#
# Copyright (C) 2020 Cinc
#
# All rights reserved.
#
# License: 3-clause BSD
#}

<div class="projects">
    # for proj in projects
    <div class="milestone">
        <div class="smp-project-group">
            <div class="info">
                <h2>${_("Project: ")}<em>${proj.name}</em>
                    # if proj.summary
                    <span> - ${proj.summary}</span>
                    # endif
                </h2>
            </div>
            <div class="smp-grouped-ms">
                ${wiki_to_html(context, proj.description)}
                # if milestones
                <hr />
                #endif
                # for milestone in milestones
                    # if proj.id in milestone.id_project
                    <div class="milestone">
                        # set mstats = milestone_stats[loop.index0]
                        <div class="info trac-progress">
                            <h3>
                                <a href="${href.milestone(milestone.name)}">Milestone: <em>${milestone.name}</em></a>
                            </h3>
                            # if milestone.completed
                            <p class="date">
                                Completed ${dateinfo(milestone.completed)} ago (${format_datetime(milestone.completed)})
                            </p>
                            #elif milestone.is_late
                            <p class="date">
                                <strong>${dateinfo(milestone.due)} late</strong> (${format_datetime(milestone.due)})
                            </p>
                            #elif milestone.due
                            <p class="date">
                                Due in ${dateinfo(milestone.due)} (${format_datetime(milestone.due)})
                            </p>
                            # else
                            <p class="date">
                                No date set
                            </p>
                            #endif
                            # if mstats.stats.count
                            # with
                            #   set stats = mstats.stats
                            #   set interval_hrefs = mstats.interval_hrefs
                            #   set stats_href = mstats.stats_href
                            #   include "progress_bar.html" ignore missing
                            # endwith
                            # endif
                        </div>
                        <div class="description">
                            ${wiki_to_html(context(milestone.resource), milestone.description)}
                        </div>
                    </div>
                    #endif
                # endfor
                {#
                 #No version display atm because the version component was removed due to licensing. See #13849.
                #}
            </div>
        </div>
    </div>
    # endfor
</div>