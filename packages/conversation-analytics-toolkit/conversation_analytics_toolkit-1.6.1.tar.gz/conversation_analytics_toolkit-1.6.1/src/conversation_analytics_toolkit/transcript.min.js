require.undef("transcript"),define("transcript",["d3"],function(d3){return function(container,config,data){config.debugger;var _config={},_chart={},_data=null;_chart.drawSelectedConversation=function(){var selectedConversation=this.data[this.selected],conversationBody=this.conversationBody;conversationBody.empty();var chipsDiv=$("<div>").appendTo(conversationBody);if("insight_tags"in selectedConversation)for(var tags=Object.keys(selectedConversation.insight_tags),i=0;i<tags.length;i++){var tag=tags[i],tagCount=selectedConversation.insight_tags[tag];$("<span>",{text:tag+" ("+tagCount+")"}).addClass("botvis-chip").appendTo(chipsDiv)}var ul=$("<ul>").addClass("botvis-timeline").appendTo(conversationBody);this.conversation_span.text(selectedConversation.conversation.id+" ("+(this.selected+1)+" of "+this.data.length+")"),selectedConversation.events.forEach(function(item){var timeline_li=$("<li>").appendTo(ul);"request"==item.type?timeline_li.addClass("botvis-timeline-inverted"):"internal"==item.type&&timeline_li.addClass("botvis-timeline-internal");var timeline_panel=$("<div>").addClass("botvis-timeline-panel").appendTo(timeline_li);"highlight"in item&&item.highlight&&timeline_panel.addClass("botvis-timeline-panel-highlighted");var timeline_heading=$("<div>").addClass("botvis-timeline-heading").appendTo(timeline_panel),timeline_body=$("<div>").addClass("botvis-timeline-body").appendTo(timeline_panel),timeline_bot_props=$("<div>").addClass("botvis-timeline-botprops").appendTo(timeline_panel);"action"in item&&$("<p>",{text:"action"+item.action}).addClass("botvis-timeline-botprops-action").appendTo(timeline_bot_props),"channel"in item&&$("<p>",{text:"channel: "+item.channel}).addClass("botvis-timeline-botprops-channel").appendTo(timeline_bot_props),"node_visited"in item&&$("<p>",{text:item.node_visited}).addClass("botvis-timeline-botprops-nodevisited").appendTo(timeline_bot_props),_config.display_fields.includes("skill_name")&&"skill_name"in item&&$("<p>",{text:"skill: "+item.skill_name}).addClass("botvis-timeline-botprops-skillname").appendTo(timeline_bot_props),_config.display_fields.includes("turn_label")&&"turn_label"in item&&$("<p>",{text:item.turn_label}).addClass("botvis-timeline-botprops-turnlabel").appendTo(timeline_bot_props),_config.display_fields.includes("nodes_visited_str")&&"nodes_visited_str"in item&&$("<p>",{text:"["+item.nodes_visited_str.join(",")+"]"}).addClass("botvis-timeline-botprops-nodevisitedstr").appendTo(timeline_bot_props),_config.display_fields.includes("nodes_visited")&&"nodes_visited"in item&&$("<p>",{text:"["+item.nodes_visited.join(",")+"]"}).addClass("botvis-timeline-botprops-nodevisited").appendTo(timeline_bot_props),$("<h4>",{text:"[ "+item.agent+" ]"}).addClass("botvis-timeline-heading").appendTo(timeline_heading);for(var i=0;i<item.messages.length;i++)$("<p>",{text:item.messages[i].text}).appendTo(timeline_body),"buttons"in item.messages[0]&&$("<p>",{text:item.messages[i].buttons}).addClass("botvis-timeline-bodyprops-buttons").appendTo(timeline_body);$("<p>",{text:item.timestamp}).addClass("botvis-timeline-time").appendTo(timeline_panel)})};var _container=container;_config=$.extend(!0,{display_fields:["turn_label","nodes_visited_str","nodes_visited"],margin:{top:20,right:90,bottom:30,left:120},width:1e3,height:600},config),_data=Array.isArray(data)?data:[data],_chart.config=_config,_chart.data=_data,_chart.selected=0,_chart.container=_container;var baHeader=$("<div>").addClass("botvis-ba-header").appendTo(_chart.container);$("<a>",{text:"IBM Conversation Analytics Toolkit | Transcript Visualizer"}).addClass("botvis-ba-label").appendTo(baHeader);var transcriptContainer=$("<div>").addClass("botvis-transcript-container").appendTo(_chart.container),conversationHeader=$("<div>").addClass("botvis-conversation-header").appendTo(transcriptContainer),conversationBody=$("<div>").addClass("botvis-conversation-body").appendTo(transcriptContainer);_chart.conversationBody=conversationBody;var clickedNavButton=function(event){"start"==event.data.command?_chart.selected=0:"next"==event.data.command?_chart.selected<_chart.data.length-1&&_chart.selected++:"prev"==event.data.command?_chart.selected>0&&_chart.selected--:"end"==event.data.command&&(_chart.selected=_chart.data.length-1),_chart.drawSelectedConversation()};$("<span>",{text:"Conversation id: "}).appendTo(conversationHeader),$("<button>",{text:"|<"}).addClass("ui-button ui-widget ui-corner-all").click({command:"start"},clickedNavButton).appendTo(conversationHeader),$("<button>",{text:"<<"}).addClass("ui-button ui-widget ui-corner-all").click({command:"prev"},clickedNavButton).appendTo(conversationHeader),_chart.conversation_span=$("<span>").addClass("botvis-conversation-id").appendTo(conversationHeader),$("<button>",{text:">>"}).addClass("ui-button ui-widget ui-corner-all").click({command:"next"},clickedNavButton).appendTo(conversationHeader),$("<button>",{text:">|"}).addClass("ui-button ui-widget ui-corner-all").click({command:"end"},clickedNavButton).appendTo(conversationHeader),_chart.drawSelectedConversation()}});